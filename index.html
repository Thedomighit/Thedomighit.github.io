<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Men√∫ Digital Ultra Premium | Edward Gonz√°lez</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary: #d4af37; /* DORADO REAL */
            --primary-glow: rgba(212, 175, 55, 0.5);
            --bg-main: #0a0a0a; /* Negro profundo */
            --bg-card: #141414;
            --bg-input: #1f1f1f;
            --text-white: #ffffff;
            --text-gold: #f5e0a3;
            --text-gray: #b3b3b3;
            --success: #25D366;
            color-scheme: dark; /* Para que los calendarios sean oscuros */
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Montserrat', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        html { scroll-behavior: smooth; }
        body { background-color: var(--bg-main); color: var(--text-white); padding-bottom: 120px; overflow-x: hidden; }

        /* --- INTRO / SPLASH SCREEN --- */
        #splash-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: #000; z-index: 9999;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            transition: opacity 0.8s ease-out;
        }
        
        .intro-logo {
            font-family: 'Cinzel', serif; color: var(--primary); font-size: 3rem;
            text-align: center; margin-bottom: 20px;
            animation: textGlow 2s infinite alternate;
        }
        
        .loader-line {
            width: 0; height: 2px; background: var(--primary);
            animation: loadLine 2s ease-in-out forwards;
        }

        @keyframes loadLine { 0% { width: 0; } 100% { width: 200px; } }
        @keyframes textGlow { from { text-shadow: 0 0 10px rgba(212,175,55,0.2); } to { text-shadow: 0 0 25px rgba(212,175,55,0.8); } }


        /* --- ESTILOS GENERALES --- */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes goldenPulse { 
            0% { box-shadow: 0 0 0 0 var(--primary-glow); } 
            70% { box-shadow: 0 0 0 15px rgba(212, 175, 55, 0); } 
            100% { box-shadow: 0 0 0 0 rgba(212, 175, 55, 0); } 
        }
        @keyframes selectionPop { 0% { transform: scale(1); } 50% { transform: scale(0.97); } 100% { transform: scale(1); } }

        /* --- HEADER --- */
        header {
            background: linear-gradient(to bottom, rgba(0,0,0,0.6), var(--bg-main)), url('https://images.unsplash.com/photo-1544025162-d76694265947?ixlib=rb-1.2.1&auto=format&fit=crop&w=1500&q=80');
            background-attachment: fixed;
            background-size: cover;
            background-position: center;
            height: 300px; /* Un poco m√°s alto para el bot√≥n de reserva */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 30px 20px;
            border-bottom: 2px solid var(--primary);
        }

        h1 {
            font-family: 'Cinzel', serif; color: var(--primary); font-size: 2.8rem;
            text-shadow: 0 4px 10px rgba(0,0,0,0.8); letter-spacing: 1px; margin-bottom: 5px;
        }
        .subtitle { color: var(--text-gray); font-size: 1rem; letter-spacing: 2px; margin-bottom: 25px; text-transform: uppercase; }

        .btn-reserve-header {
            background: transparent; border: 1px solid var(--primary); color: var(--primary);
            padding: 12px 30px; font-family: 'Cinzel', serif; font-weight: bold; font-size: 0.9rem;
            cursor: pointer; transition: 0.3s; letter-spacing: 1px;
        }
        .btn-reserve-header:hover { background: var(--primary); color: black; box-shadow: 0 0 20px var(--primary-glow); }

        /* --- NAVEGACI√ìN --- */
        .categories-container {
            position: sticky; top: 0; z-index: 100;
            background: rgba(10, 10, 10, 0.95); backdrop-filter: blur(10px);
            padding: 15px 0; border-bottom: 1px solid #333;
            box-shadow: 0 10px 20px rgba(0,0,0,0.5);
        }
        .categories { display: flex; overflow-x: auto; padding: 0 20px; gap: 15px; scrollbar-width: none; }
        .categories::-webkit-scrollbar { display: none; }

        .cat-btn {
            background: transparent; border: 1px solid #444; color: var(--text-gray);
            padding: 10px 20px; border-radius: 50px; white-space: nowrap;
            transition: 0.4s; font-size: 0.9rem; font-weight: 600;
        }
        .cat-btn.active {
            background: var(--primary); color: #000; border-color: var(--primary);
            box-shadow: 0 0 15px var(--primary-glow); transform: scale(1.05);
        }
        /* Bot√≥n especial de reservas en el nav */
        .cat-btn.reserve-nav { border-color: var(--primary); color: var(--primary); }

        /* --- GRID --- */
        .menu-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: 20px; padding: 25px 20px;
        }

        .product-card {
            background: var(--bg-card); border-radius: 15px; overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.4); border: 1px solid #222;
            transition: all 0.3s ease; position: relative; animation: fadeIn 0.6s ease backwards;
        }
        .product-card:hover { transform: translateY(-5px); border-color: var(--primary); }

        .product-img-container { height: 140px; overflow: hidden; position: relative; }
        .product-img { width: 100%; height: 100%; object-fit: cover; transition: 0.5s; }
        .product-card:hover .product-img { transform: scale(1.1); }

        .product-info { padding: 15px; }
        .product-title { color: var(--text-white); font-weight: 700; margin-bottom: 5px; font-size: 1rem; }
        .product-desc { color: #888; font-size: 0.75rem; height: 35px; overflow: hidden; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; margin-bottom: 10px; }
        
        .price-row { display: flex; justify-content: space-between; align-items: center; }
        .product-price { color: var(--primary); font-family: 'Cinzel', serif; font-weight: 700; font-size: 1.1rem; }
        
        .add-icon { 
            background: linear-gradient(45deg, var(--primary), #b8860b);
            color: black; width: 32px; height: 32px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 4px 10px rgba(212, 175, 55, 0.3);
        }

        /* --- MODALES --- */
        .modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); z-index: 2000; align-items: flex-end;
            backdrop-filter: blur(8px);
        }
        .modal.active { display: flex; }
        
        .modal-content {
            background: var(--bg-card); width: 100%; max-width: 600px;
            height: 92vh; border-radius: 30px 30px 0 0;
            display: flex; flex-direction: column; overflow: hidden;
            border-top: 1px solid var(--primary);
            box-shadow: 0 -10px 40px rgba(0,0,0,0.8);
            animation: slideUp 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
            margin: 0 auto;
        }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }

        @media(min-width: 768px) {
            .modal { align-items: center; justify-content: center; }
            .modal-content { height: auto; max-height: 85vh; border-radius: 30px; border: 1px solid #333; }
        }

        .modal-header-img {
            min-height: 200px; background-size: cover; background-position: center; position: relative;
        }
        .close-btn {
            position: absolute; top: 20px; right: 20px;
            background: rgba(0,0,0,0.6); color: white; border: none;
            width: 40px; height: 40px; border-radius: 50%; cursor: pointer;
            font-size: 1.2rem; display: flex; align-items: center; justify-content: center;
            transition: 0.3s; z-index: 5;
        }
        .close-btn:hover { background: #ff4444; transform: rotate(90deg); }

        .modal-body { padding: 25px; overflow-y: auto; flex: 1; }
        .modal-title { font-family: 'Cinzel', serif; font-size: 1.8rem; color: var(--primary); margin-bottom: 8px; line-height: 1.2; }
        .modal-desc { color: #aaa; font-size: 0.9rem; line-height: 1.5; margin-bottom: 25px; }

        /* --- DETALLES --- */
        .option-group { margin-bottom: 30px; }
        .group-title { 
            font-size: 0.85rem; text-transform: uppercase; letter-spacing: 1.5px; color: var(--text-gray); 
            margin-bottom: 12px; border-left: 3px solid var(--primary); padding-left: 10px; font-weight: 700;
        }

        .option-item {
            display: flex; justify-content: space-between; align-items: center;
            padding: 16px; background: var(--bg-input); border: 1px solid #333;
            border-radius: 12px; margin-bottom: 10px; cursor: pointer;
            transition: all 0.2s ease; position: relative; overflow: hidden;
        }
        .option-item.selected {
            border-color: var(--primary);
            background: linear-gradient(to right, rgba(212, 175, 55, 0.15), rgba(0,0,0,0));
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.15);
            animation: selectionPop 0.3s ease;
        }
        .option-text { font-weight: 500; font-size: 0.95rem; color: #eee; }
        .option-price { color: var(--primary); font-size: 0.85rem; font-weight: 600; }
        .check-circle {
            width: 24px; height: 24px; border-radius: 50%; border: 2px solid #555;
            display: flex; align-items: center; justify-content: center; transition: 0.3s;
        }
        .option-item.selected .check-circle {
            background: var(--primary); border-color: var(--primary); box-shadow: 0 0 8px var(--primary);
        }
        .check-circle i { font-size: 12px; color: black; opacity: 0; transform: scale(0); transition: 0.3s; }
        .option-item.selected .check-circle i { opacity: 1; transform: scale(1); }

        .qty-control {
            display: flex; align-items: center; background: #222; border-radius: 50px; padding: 5px; width: fit-content; margin-bottom: 25px; border: 1px solid #333;
        }
        .qty-btn { 
            width: 40px; height: 40px; border-radius: 50%; background: #333; color: white; border: none; font-size: 1.2rem; cursor: pointer; transition: 0.2s;
        }
        .qty-val { margin: 0 20px; font-weight: bold; font-size: 1.2rem; min-width: 20px; text-align: center; }

        textarea, input, select {
            width: 100%; background: var(--bg-input); border: 1px solid #333; color: white;
            padding: 15px; border-radius: 12px; margin-bottom: 10px; outline: none; transition: 0.3s; font-size: 1rem;
        }
        textarea:focus, input:focus, select:focus { border-color: var(--primary); box-shadow: 0 0 10px rgba(212,175,55,0.1); }

        /* Estilo para inputs de fecha en oscuro */
        input[type="date"]::-webkit-calendar-picker-indicator,
        input[type="time"]::-webkit-calendar-picker-indicator {
            filter: invert(1); cursor: pointer;
        }

        .modal-footer {
            padding: 20px; background: var(--bg-card); border-top: 1px solid #222;
            box-shadow: 0 -5px 20px rgba(0,0,0,0.5);
        }

        .action-btn {
            width: 100%; padding: 18px; border: none; border-radius: 15px;
            font-weight: 800; font-size: 1.1rem; cursor: pointer;
            display: flex; justify-content: space-between; align-items: center;
            text-transform: uppercase; letter-spacing: 1px;
        }
        .btn-gold { 
            background: linear-gradient(45deg, #d4af37, #f3d472); color: #000;
            box-shadow: 0 5px 20px rgba(212, 175, 55, 0.3); animation: goldenPulse 2s infinite;
        }
        .btn-whatsapp { background: #25D366; color: white; justify-content: center; gap: 10px; }

        .float-cart {
            position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%);
            width: 90%; max-width: 450px; z-index: 1500;
        }
    </style>
</head>
<body>

    <div id="splash-screen">
        <h1 class="intro-logo">Gourmet & Grill</h1>
        <div class="loader-line"></div>
    </div>

    <header>
        <div class="header-content animated fadeIn">
            <h1>Gourmet & Grill</h1>
            <p class="subtitle">EXPERIENCIA CULINARIA PREMIUM</p>
            <button class="btn-reserve-header" onclick="openReservationModal()">RESERVAR MESA</button>
        </div>
    </header>

    <div class="categories-container" id="nav-container">
        <div class="categories">
            <button class="cat-btn active" onclick="renderMenu('all', this)">TODOS</button>
            <button class="cat-btn" onclick="renderMenu('Hamburguesas', this)">HAMBURGUESAS</button>
            <button class="cat-btn" onclick="renderMenu('Carnes', this)">CARNES</button>
            <button class="cat-btn" onclick="renderMenu('Pizzas', this)">PIZZAS</button>
            <button class="cat-btn" onclick="renderMenu('Bebidas', this)">BEBIDAS</button>
            <button class="cat-btn reserve-nav" onclick="openReservationModal()"><i class="fas fa-calendar-alt"></i> RESERVAS</button>
        </div>
    </div>

    <div class="menu-grid" id="grid"></div>

    <div id="product-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header-img" id="p-img">
                <button class="close-btn" onclick="closeModal('product-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <h2 id="p-title" class="modal-title"></h2>
                <p id="p-desc" class="modal-desc"></p>
                <div class="qty-control">
                    <button class="qty-btn" onclick="updateQty(-1)">-</button>
                    <span class="qty-val" id="p-qty">1</span>
                    <button class="qty-btn" onclick="updateQty(1)">+</button>
                </div>
                <div id="p-options"></div>
                <div class="option-group">
                    <div class="group-title">Notas de Cocina</div>
                    <textarea id="p-notes" rows="2" placeholder="Ej: Sin sal, salsa aparte..."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="action-btn btn-gold" onclick="addToCart()">
                    <span>AGREGAR</span>
                    <span id="p-total-btn">$0</span>
                </button>
            </div>
        </div>
    </div>

    <div id="checkout-modal" class="modal">
        <div class="modal-content">
            <div style="padding: 20px; border-bottom: 1px solid #333; display: flex; justify-content: space-between; align-items: center;">
                <h2 style="color: var(--primary); margin:0; font-family: 'Cinzel', serif;">TU PEDIDO</h2>
                <button class="close-btn" style="position:static; transform:none;" onclick="closeModal('checkout-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div id="cart-list"></div>
                <div class="option-group" style="margin-top: 30px;">
                    <div class="group-title">Datos de Entrega</div>
                    <input type="text" id="c-name" placeholder="Tu Nombre Completo">
                    <select id="c-type" onchange="toggleDelivery()">
                        <option value="mesa">Comer en la Mesa</option>
                        <option value="llevar">Domicilio / Para Llevar</option>
                    </select>
                    <div id="field-mesa"><select id="c-table"><option value="">Selecciona Mesa</option><option value="1">Mesa 1</option><option value="2">Mesa 2</option><option value="3">Mesa 3</option><option value="4">Mesa 4</option></select></div>
                    <div id="field-addr" style="display:none;"><textarea id="c-addr" rows="2" placeholder="Direcci√≥n Exacta"></textarea></div>
                </div>
            </div>
            <div class="modal-footer">
                <div style="display:flex; justify-content:space-between; margin-bottom:15px; font-size:1.2rem; font-weight:bold;">
                    <span>TOTAL:</span>
                    <span id="cart-final-total" style="color:var(--primary);">$0</span>
                </div>
                <button class="action-btn btn-whatsapp" onclick="sendWhatsapp()">
                    <i class="fab fa-whatsapp"></i> ENVIAR PEDIDO
                </button>
            </div>
        </div>
    </div>

    <div id="reservation-modal" class="modal">
        <div class="modal-content">
            <div style="padding: 20px; border-bottom: 1px solid #333; display: flex; justify-content: space-between; align-items: center;">
                <h2 style="color: var(--primary); margin:0; font-family: 'Cinzel', serif;">RESERVAR MESA</h2>
                <button class="close-btn" style="position:static; transform:none;" onclick="closeModal('reservation-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <p style="color:#aaa; font-size:0.9rem; margin-bottom:20px;">Completa los datos para confirmar tu mesa.</p>
                
                <div class="option-group">
                    <div class="group-title"><i class="fas fa-user"></i> Datos del Cliente</div>
                    <input type="text" id="r-name" placeholder="Nombre Completo">
                </div>

                <div class="option-group">
                    <div class="group-title"><i class="fas fa-clock"></i> Fecha y Hora</div>
                    <input type="date" id="r-date">
                    <input type="time" id="r-time">
                </div>

                <div class="option-group">
                    <div class="group-title"><i class="fas fa-users"></i> N√∫mero de Personas</div>
                    <select id="r-people">
                        <option value="2">2 Personas</option>
                        <option value="3">3 Personas</option>
                        <option value="4">4 Personas</option>
                        <option value="5">5 Personas</option>
                        <option value="6">6 Personas</option>
                        <option value="Mas de 6">+ de 6 (Grupo Grande)</option>
                    </select>
                </div>

                <div class="option-group">
                    <div class="group-title"><i class="fas fa-comment"></i> Peticiones Especiales</div>
                    <textarea id="r-notes" rows="2" placeholder="Ej: Cumplea√±os, Aniversario, Mesa tranquila..."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="action-btn btn-whatsapp" onclick="sendReservation()">
                    <i class="fab fa-whatsapp"></i> CONFIRMAR RESERVA
                </button>
            </div>
        </div>
    </div>

    <div class="float-cart" id="float-btn" style="display: none;">
        <button class="action-btn btn-gold" onclick="openCheckout()">
            <span><i class="fas fa-shopping-bag"></i> <span id="cart-count">0</span></span>
            <span id="cart-sum">$0</span>
        </button>
    </div>

    <script>
        const PHONE = "573008556516";

        // --- L√ìGICA INTRO ---
        window.onload = function() {
            setTimeout(() => {
                const splash = document.getElementById('splash-screen');
                splash.style.opacity = '0';
                setTimeout(() => { splash.style.display = 'none'; }, 800);
            }, 2000); // 2 segundos
        };

        const data = [
            {
                id: 201, name: "Ribeye Steak Premium (400g)", price: 65000, category: "Carnes",
                desc: "Corte importado de la mejor calidad, jugoso y con marmoleo perfecto. Asado a la parrilla.",
                img: "https://images.unsplash.com/photo-1546964124-0cce460f38ef?auto=format&fit=crop&w=800&q=80",
                groups: [
                    { title: "1. T√©rmino de la Carne (Obligatorio)", type: "radio", opts: [ {n:"Azul", p:0}, {n:"Medio", p:0}, {n:"Tres Cuartos", p:0}, {n:"Bien Asado", p:0} ] },
                    { title: "2. Elige tu Salsa", type: "radio", opts: [ {n:"Salsa de la Casa (BBQ)", p:0}, {n:"Salsa Pimienta", p:0}, {n:"Champi√±ones (+3k)", p:3000}, {n:"Sin Salsa", p:0} ] },
                    { title: "3. Acompa√±amiento", type: "radio", opts: [ {n:"Papas Francesa", p:0}, {n:"Pur√© de Papa", p:0}, {n:"Ensalada", p:0}, {n:"Arroz", p:0}, {n:"Papas Criollas", p:0} ] },
                    { title: "4. ¬øDeseas Bebida?", type: "radio", opts: [ {n:"No, gracias", p:0}, {n:"Coca Cola (+5k)", p:5000}, {n:"Limonada (+8k)", p:8000}, {n:"Corona (+10k)", p:10000} ] }
                ]
            },
            {
                id: 202, name: "Churrasco Argentino", price: 45000, category: "Carnes",
                desc: "Corte mariposa cl√°sico, ba√±ado en chimichurri artesanal.",
                img: "https://images.unsplash.com/photo-1558030006-450675393462?auto=format&fit=crop&w=800&q=80",
                groups: [ { title: "T√©rmino", type: "radio", opts: [{n:"Medio", p:0}, {n:"3/4", p:0}, {n:"Bien Asado", p:0}] }, { title: "Acompa√±amiento", type: "radio", opts: [{n:"Papas Fritas", p:0}, {n:"Yuca Frita", p:0}, {n:"Patac√≥n", p:0}] } ]
            },
            {
                id: 101, name: "Master Burger Double", price: 32000, category: "Hamburguesas",
                desc: "Doble carne angus certificada, doble cheddar fundido, tocineta ahumada y cebolla caramelizada.",
                img: "https://images.unsplash.com/photo-1568901346375-23c9450c58cd?auto=format&fit=crop&w=800&q=80",
                groups: [ { title: "Personaliza", type: "check", opts: [ {n:"Sin Cebolla",p:0}, {n:"Sin Tocineta",p:0}, {n:"Sin Salsas",p:0} ] }, { title: "Adiciones", type: "check", opts: [ {n:"Extra Queso (+4k)",p:4000}, {n:"Huevo Frito (+3k)",p:3000}, {n:"Pepinillos (+2k)",p:2000} ] }, { title: "Tipo de Papas", type: "radio", opts: [ {n:"Papas Francesa",p:0}, {n:"Papas R√∫sticas",p:2000}, {n:"Sin Papas",p:0} ] } ]
            },
            {
                id: 301, name: "Pizza Burrata & Pesto", price: 35000, category: "Pizzas",
                desc: "Tomate San Marzano, Burrata fresca entera (125g) y Pesto genov√©s.",
                img: "https://images.unsplash.com/photo-1595854341625-f33ee10dbf94?auto=format&fit=crop&w=800&q=80",
                groups: [ { title: "Borde", type: "radio", opts: [ {n:"Tradicional",p:0}, {n:"Borde Queso (+6k)",p:6000}, {n:"Borde Bocadillo (+5k)",p:5000} ] }, { title: "Adiciones", type: "check", opts: [ {n:"Extra Jam√≥n (+8k)",p:8000}, {n:"Extra Burrata (+12k)",p:12000} ] } ]
            },
            {
                id: 401, name: "Limonada de Coco", price: 12000, category: "Bebidas",
                desc: "Cremosa y refrescante con coco natural. Granizada.",
                img: "https://images.unsplash.com/photo-1513558161293-cdaf765ed2fd?auto=format&fit=crop&w=800&q=80",
                groups: [ { title: "Preferencia", type: "radio", opts: [{n:"Con Az√∫car", p:0}, {n:"Sin Az√∫car", p:0}, {n:"Poca Az√∫car", p:0}] } ]
            },
            {
                id: 402, name: "Agua Manantial Sin Gas", price: 5000, category: "Bebidas",
                desc: "Botella de agua pura cristalina 500ml.",
                img: "https://images.unsplash.com/photo-1548839140-29a749e1cf4d?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80",
                groups: [ { title: "Temperatura", type: "radio", opts: [{n:"Al Clima", p:0}, {n:"Fr√≠a", p:0}, {n:"Vaso con Hielo", p:0}] } ]
            },
             {
                id: 403, name: "Coca Cola Zero", price: 5000, category: "Bebidas",
                desc: "Lata 330ml fr√≠a.",
                img: "https://images.unsplash.com/photo-1622483767028-3f66f32aef97?auto=format&fit=crop&w=800&q=80",
                groups: [ { title: "Servicio", type: "radio", opts: [{n:"Vaso con Hielo", p:0}, {n:"Sin Vaso", p:0}] } ]
            }
        ];

        let cart = [];
        let currItem = null;
        let currQty = 1;

        function renderMenu(filter, btn) {
            if(btn) {
                document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
            }
            const grid = document.getElementById('grid');
            grid.innerHTML = '';
            const list = filter === 'all' ? data : data.filter(i => i.category === filter);
            list.forEach(item => {
                const card = document.createElement('div');
                card.className = 'product-card';
                card.onclick = () => openModal(item);
                card.innerHTML = `
                    <div class="product-img-container"><img src="${item.img}" class="product-img"></div>
                    <div class="product-info">
                        <div class="product-title">${item.name}</div>
                        <div class="product-desc">${item.desc}</div>
                        <div class="price-row">
                            <span class="product-price">$${item.price.toLocaleString()}</span>
                            <div class="add-icon"><i class="fas fa-plus"></i></div>
                        </div>
                    </div>`;
                grid.appendChild(card);
            });
            if(btn) {
                const offset = document.getElementById('nav-container').offsetHeight;
                const top = grid.getBoundingClientRect().top + window.pageYOffset - offset - 20;
                window.scrollTo({top: top, behavior: 'smooth'});
            }
        }

        function openModal(item) {
            currItem = item;
            currQty = 1;
            document.getElementById('p-img').style.backgroundImage = `url('${item.img}')`;
            document.getElementById('p-title').innerText = item.name;
            document.getElementById('p-desc').innerText = item.desc;
            document.getElementById('p-qty').innerText = 1;
            document.getElementById('p-notes').value = '';
            const optsDiv = document.getElementById('p-options');
            optsDiv.innerHTML = '';
            if(item.groups) {
                item.groups.forEach((g, i) => {
                    let html = `<div class="option-group"><div class="group-title">${g.title}</div>`;
                    g.opts.forEach((opt, j) => {
                        const uid = `opt-${i}-${j}`;
                        html += `
                        <div class="option-item" onclick="toggleOpt(this, '${g.type}', '${i}')" id="${uid}" data-price="${opt.p}" data-name="${opt.n}">
                            <div><div class="option-text">${opt.n}</div>${opt.p > 0 ? `<div class="option-price">+$${opt.p.toLocaleString()}</div>` : ''}</div>
                            <div class="check-circle"><i class="fas fa-check"></i></div>
                        </div>`;
                    });
                    html += `</div>`;
                    optsDiv.innerHTML += html;
                });
            }
            calcTotal();
            document.getElementById('product-modal').classList.add('active');
        }

        function toggleOpt(el, type, groupId) {
            if(type === 'radio') {
                const siblings = el.parentElement.querySelectorAll('.option-item');
                siblings.forEach(sib => sib.classList.remove('selected'));
                el.classList.add('selected');
            } else { el.classList.toggle('selected'); }
            calcTotal();
        }

        function updateQty(n) {
            currQty += n;
            if(currQty < 1) currQty = 1;
            document.getElementById('p-qty').innerText = currQty;
            calcTotal();
        }

        function calcTotal() {
            let total = currItem.price;
            document.querySelectorAll('.option-item.selected').forEach(el => total += parseFloat(el.dataset.price));
            total *= currQty;
            document.getElementById('p-total-btn').innerText = `$${total.toLocaleString()}`;
            return total;
        }

        function closeModal(id) { document.getElementById(id).classList.remove('active'); }

        function addToCart() {
            const opts = [];
            document.querySelectorAll('.option-item.selected').forEach(el => opts.push(el.dataset.name));
            cart.push({ item: currItem, qty: currQty, opts: opts, notes: document.getElementById('p-notes').value, total: calcTotal() });
            updateCartUI();
            closeModal('product-modal');
        }

        function updateCartUI() {
            const count = cart.reduce((a,b)=>a+b.qty,0);
            const sum = cart.reduce((a,b)=>a+b.total,0);
            document.getElementById('cart-count').innerText = count;
            document.getElementById('cart-sum').innerText = `$${sum.toLocaleString()}`;
            document.getElementById('cart-final-total').innerText = `$${sum.toLocaleString()}`;
            document.getElementById('float-btn').style.display = count > 0 ? 'block' : 'none';
            if(count === 0) closeModal('checkout-modal');
        }

        function openCheckout() {
            const list = document.getElementById('cart-list');
            list.innerHTML = '';
            cart.forEach((c, i) => {
                list.innerHTML += `
                <div style="background:#1f1f1f; padding:15px; border-radius:10px; margin-bottom:10px; border:1px solid #333;">
                    <div style="display:flex; justify-content:space-between; font-weight:bold;">
                        <span><span style="color:var(--primary)">${c.qty}x</span> ${c.item.name}</span>
                        <span>$${c.total.toLocaleString()}</span>
                    </div>
                    <div style="font-size:0.85rem; color:#888; margin-top:5px;">${c.opts.join(', ')}</div>
                    ${c.notes ? `<div style="font-size:0.8rem; color:#aaa; font-style:italic;">"${c.notes}"</div>` : ''}
                    <div style="text-align:right; margin-top:5px; color:#ff4444; font-size:0.8rem; cursor:pointer;" onclick="remItem(${i})">Eliminar</div>
                </div>`;
            });
            toggleDelivery();
            document.getElementById('checkout-modal').classList.add('active');
        }

        function remItem(i) { cart.splice(i,1); updateCartUI(); openCheckout(); }

        function toggleDelivery() {
            const type = document.getElementById('c-type').value;
            document.getElementById('field-mesa').style.display = type === 'mesa' ? 'block' : 'none';
            document.getElementById('field-addr').style.display = type === 'llevar' ? 'block' : 'none';
        }

        function sendWhatsapp() {
            const name = document.getElementById('c-name').value;
            if(!name) return alert("Por favor escribe tu nombre");
            let msg = `*NUEVO PEDIDO DE ${name.toUpperCase()}*%0A%0A`;
            cart.forEach(c => {
                msg += `üëâ *${c.qty}x ${c.item.name}* ($${c.total.toLocaleString()})%0A`;
                if(c.opts.length) msg += `   [${c.opts.join(', ')}]%0A`;
                if(c.notes) msg += `   _${c.notes}_%0A`;
                msg += `%0A`;
            });
            const type = document.getElementById('c-type').value;
            const loc = type === 'mesa' ? `Mesa ${document.getElementById('c-table').value}` : `Direcci√≥n: ${document.getElementById('c-addr').value}`;
            msg += `üí∞ *TOTAL: ${document.getElementById('cart-final-total').innerText}*%0A`;
            msg += `üìç *ENTREGA:* ${loc}`;
            window.open(`https://wa.me/${PHONE}?text=${msg}`, '_blank');
        }

        // --- FUNCIONES DE RESERVA ---
        function openReservationModal() {
            document.getElementById('reservation-modal').classList.add('active');
        }

        function sendReservation() {
            const name = document.getElementById('r-name').value;
            const date = document.getElementById('r-date').value;
            const time = document.getElementById('r-time').value;
            const people = document.getElementById('r-people').value;
            const notes = document.getElementById('r-notes').value;

            if(!name || !date || !time) return alert("Por favor completa nombre, fecha y hora.");

            let msg = `üìÖ *NUEVA RESERVA DE MESA*%0A%0A`;
            msg += `üë§ *Nombre:* ${name}%0A`;
            msg += `üìÜ *Fecha:* ${date}%0A`;
            msg += `‚è∞ *Hora:* ${time}%0A`;
            msg += `üë• *Personas:* ${people}%0A`;
            if(notes) msg += `üìù *Nota:* ${notes}%0A`;

            window.open(`https://wa.me/${PHONE}?text=${msg}`, '_blank');
        }

        renderMenu('all');
    </script>
</body>
</html>
